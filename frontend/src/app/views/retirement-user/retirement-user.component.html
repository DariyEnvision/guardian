<ng-container [ngTemplateOutlet]="!loading && !isConfirmed ? noDIDSettings : contractsTable"></ng-container>

<ng-template #contractsTable>
    <div *ngIf="contractRequests" class="retirement-container">
        <h1>Retirement</h1>
        <div class="actions-container">
            <div class="buttons-container">
                <button
                        (click)="createRetireRequest()"
                        class="button"
                        icon="pi pi-plus"
                        iconPos="left"
                        label="Create Retire Request"
                        pButton
                ></button>
            </div>
        </div>
        <ng-container *ngIf="contractRequests.length > 0 else noData">
            <p-table [value]="contractRequests">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Contract Id</th>
                        <th>Base Token Id</th>
                        <th>Opposite Token Id</th>
                        <th>Base Token Count</th>
                        <th>Opposite Token Count</th>
                        <th>Operations</th>
                    </tr>
                </ng-template>
                <ng-template let-element pTemplate="body">
                    <tr>
                        <td>
                            <hedera-explorer [params]="element.contractId"
                                             type="accounts">{{ element.contractId }}
                            </hedera-explorer>
                        </td>
                        <hedera-explorer [params]="element.baseTokenId"
                                         type="tokens">{{ element.baseTokenId }}
                        </hedera-explorer>
                        <td>
                            <hedera-explorer [params]="element.oppositeTokenId"
                                             type="tokens">{{ element.oppositeTokenId }}
                            </hedera-explorer>
                        </td>
                        <td>
                            {{ element.baseTokenCount }}
                        </td>
                        <td>
                            {{ element.oppositeTokenCount }}
                        </td>
                        <td>
                            <div (click)="cancelContractRequest(element.id)" *ngIf="!element.vcDocument"
                                 class="cancel-action-btn">
                                <span>Cancel Request</span>
                                <i class="pi pi-times-circle"></i>
                            </div>
                            <div (click)="viewRetireRequest(element.vcDocument)" *ngIf="element.vcDocument"
                                 class="view-action-btn">
                                <span>View Details</span>
                                <i class="pi pi-file-o"></i>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="table-paginator">
                <span>Items per page:</span>
                <p-dropdown
                        (onChange)="newOnPage()"
                        [(ngModel)]="pageSize"
                        [options]="[10, 25, 50, 100]"
                ></p-dropdown>
                <span class="color-grey-6"
                >{{ pageIndex * pageSize + 1 }} â€“
                    {{
                        pageIndex * pageSize + pageSize > contractsCount
                            ? contractsCount
                            : pageIndex * pageSize + pageSize
                    }}
                    of {{ contractsCount }}</span
                >
                <div class="flex">
                    <svg
                            (click)="movePageIndex(-1)"
                            fill="none"
                            height="24"
                            viewBox="0 0 24 24"
                            width="24"
                            xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                                d="M15.2828 5.68906C14.8923 5.29856 14.2591 5.29856 13.8686 5.68906L8.98115 10.5813C8.20075 11.3625 8.20106 12.6283 8.98184 13.4091L13.8722 18.2994C14.2627 18.6899 14.8959 18.6899 15.2864 18.2994C15.677 17.9089 15.677 17.2757 15.2864 16.8852L11.1008 12.6996C10.7103 12.309 10.7103 11.6759 11.1008 11.2854L15.2828 7.10326C15.6733 6.71276 15.6733 6.07956 15.2828 5.68906Z"
                                fill="#848FA9"
                        />
                    </svg>
                    <svg
                            (click)="movePageIndex(+1)"
                            fill="none"
                            height="24"
                            viewBox="0 0 24 24"
                            width="24"
                            xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                                d="M8.6926 5.68907C9.0831 5.29857 9.7163 5.29857 10.1068 5.68907L14.9942 10.5813C15.7746 11.3625 15.7743 12.6283 14.9936 13.4091L10.1032 18.2994C9.7127 18.6899 9.0795 18.6899 8.689 18.2994C8.2984 17.9089 8.2984 17.2757 8.689 16.8852L12.8746 12.6996C13.2651 12.309 13.2651 11.6759 12.8746 11.2854L8.6926 7.10327C8.3021 6.71277 8.3021 6.07957 8.6926 5.68907Z"
                                fill="#848FA9"
                        />
                    </svg>
                </div>
            </div>
        </ng-container>
    </div>
</ng-template>

<ng-template #noDIDSettings>
    <div class="not-exist">
        <span>Before starting work you need to get DID <a [routerLink]="['/profile']">here</a></span>
    </div>
</ng-template>

<ng-template #noData>
    <div class="not-exist">
        <svg fill="none" height="32" viewBox="0 0 32 32" width="32" xmlns="http://www.w3.org/2000/svg">
            <path class="disabled-color" clip-rule="evenodd" d="M2.66699 8C2.66699 6.89543 3.56243 6 4.66699 6C5.77156 6 6.66699 6.89543 6.66699 8C6.66699 9.10457 5.77156 10 4.66699 10C3.56243 10 2.66699 9.10457 2.66699 8ZM9.33366 8.00082C9.3337 7.26444 9.93069 6.66752 10.6671 6.66756L28.0004 6.66852C28.7368 6.66856 29.3337 7.26555 29.3337 8.00193C29.3336 8.73831 28.7366 9.33523 28.0002 9.33519L10.6669 9.33423C9.93054 9.33419 9.33362 8.7372 9.33366 8.00082ZM2.66699 16C2.66699 14.8956 3.56236 14 4.66699 14C5.77163 14 6.66699 14.8956 6.66699 16C6.66699 17.1044 5.77163 18 4.66699 18C3.56236 18 2.66699 17.1044 2.66699 16ZM9.33366 16.0009C9.3337 15.2645 9.93069 14.6676 10.6671 14.6676L28.0004 14.6687C28.7368 14.6687 29.3337 15.2657 29.3337 16.0021C29.3336 16.7385 28.7366 17.3354 28.0002 17.3353L10.6669 17.3343C9.93053 17.3342 9.33361 16.7372 9.33366 16.0009ZM2.66699 24C2.66699 22.8956 3.56236 22 4.66699 22C5.77163 22 6.66699 22.8956 6.66699 24C6.66699 25.1044 5.77163 26 4.66699 26C3.56236 26 2.66699 25.1044 2.66699 24ZM9.33366 24.0009C9.3337 23.2645 9.93069 22.6676 10.6671 22.6676L28.0004 22.6687C28.7368 22.6687 29.3337 23.2657 29.3337 24.0021C29.3336 24.7385 28.7366 25.3354 28.0002 25.3353L10.6669 25.3343C9.93053 25.3342 9.33361 24.7372 9.33366 24.0009Z"
                  fill-rule="evenodd"/>
        </svg>
        <span class="info-text-strong">There were no data created yet</span>
        <span class="info-text">Please create new retire request to see the data</span>
    </div>
</ng-template>

<ng-template #preloader>
    <div class="preloader-image"></div>
</ng-template>

<div *ngIf="loading" class="loading">
    <div class="preloader-image preloader-image-l-size"></div>
</div>
